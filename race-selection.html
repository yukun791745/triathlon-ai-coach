<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãƒˆãƒ©ã‚¤ã‚¢ã‚¹ãƒ­ãƒ³å¤§ä¼šä¸€è¦§ 2025</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
            color: white;
            text-align: center;
            padding: 40px 20px;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        .filters {
            padding: 30px;
            background: #f8f9fa;
            border-bottom: 1px solid #e9ecef;
        }

        .filter-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
        }

        .filter-group label {
            font-weight: 600;
            margin-bottom: 8px;
            color: #333;
            font-size: 0.9rem;
        }

        .filter-group select, .filter-group input {
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .filter-group select:focus, .filter-group input:focus {
            outline: none;
            border-color: #4CAF50;
            box-shadow: 0 0 0 3px rgba(76, 175, 80, 0.1);
        }

        .stats {
            text-align: center;
            padding: 20px 30px;
            background: #e8f5e8;
            border-bottom: 1px solid #d4edda;
        }

        .stats h3 {
            color: #2e7d32;
            font-size: 1.3rem;
        }

        .race-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 25px;
            padding: 30px;
        }

        .race-card {
            background: white;
            border-radius: 15px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            overflow: hidden;
            border: 2px solid transparent;
        }

        .race-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0,0,0,0.2);
            border-color: #4CAF50;
        }

        .race-card-header {
            background: linear-gradient(135deg, #2196F3 0%, #1976D2 100%);
            color: white;
            padding: 20px;
            text-align: center;
        }

        .race-card-header h3 {
            font-size: 1.3rem;
            margin-bottom: 5px;
        }

        .race-card-body {
            padding: 20px;
        }

        .race-info {
            display: grid;
            gap: 12px;
        }

        .race-info-item {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .race-info-item .icon {
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #f0f0f0;
            border-radius: 50%;
            font-size: 0.8rem;
        }

        .race-info-item .text {
            flex: 1;
            font-size: 0.95rem;
        }

        .distance-badge {
            background: linear-gradient(135deg, #FF9800 0%, #F57C00 100%);
            color: white;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            display: inline-block;
            margin-top: 10px;
        }

        .distance-badge.olympic {
            background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
        }

        .distance-badge.sprint {
            background: linear-gradient(135deg, #2196F3 0%, #1976D2 100%);
        }

        .distance-badge.long {
            background: linear-gradient(135deg, #9C27B0 0%, #7B1FA2 100%);
        }

        .no-results {
            text-align: center;
            padding: 60px 20px;
            color: #666;
        }

        .no-results h3 {
            font-size: 1.5rem;
            margin-bottom: 10px;
        }

        .debug-info {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            padding: 15px;
            margin: 20px 30px;
            border-radius: 8px;
            font-family: monospace;
            font-size: 0.9rem;
        }

        @media (max-width: 768px) {
            .container {
                margin: 10px;
                border-radius: 15px;
            }

            .header h1 {
                font-size: 2rem;
            }

            .filter-row {
                grid-template-columns: 1fr;
                gap: 15px;
            }

            .race-grid {
                grid-template-columns: 1fr;
                padding: 20px;
                gap: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸŠâ€â™‚ï¸ğŸš´â€â™‚ï¸ğŸƒâ€â™‚ï¸ ãƒˆãƒ©ã‚¤ã‚¢ã‚¹ãƒ­ãƒ³å¤§ä¼šä¸€è¦§ 2025</h1>
            <p>å…¨å›½ã®ãƒˆãƒ©ã‚¤ã‚¢ã‚¹ãƒ­ãƒ³å¤§ä¼šæƒ…å ±ã‚’ãƒã‚§ãƒƒã‚¯ï¼</p>
        </div>

        <div class="filters">
            <div class="filter-row">
                <div class="filter-group">
                    <label for="region-select">ğŸ—¾ åœ°åŸŸ</label>
                    <select id="region-select">
                        <option value="">ã™ã¹ã¦ã®åœ°åŸŸ</option>
                        <option value="åŒ—æµ·é“">åŒ—æµ·é“</option>
                        <option value="æ±åŒ—">æ±åŒ—</option>
                        <option value="é–¢æ±">é–¢æ±</option>
                        <option value="ä¸­éƒ¨">ä¸­éƒ¨</option>
                        <option value="é–¢è¥¿">é–¢è¥¿</option>
                        <option value="ä¸­å›½">ä¸­å›½</option>
                        <option value="å››å›½">å››å›½</option>
                        <option value="ä¹å·">ä¹å·</option>
                        <option value="æ²–ç¸„">æ²–ç¸„</option>
                    </select>
                </div>

                <div class="filter-group">
                    <label for="month-select">ğŸ“… é–‹å‚¬æœˆ</label>
                    <select id="month-select">
                        <option value="">ã™ã¹ã¦ã®æœˆ</option>
                        <option value="4">4æœˆ</option>
                        <option value="5">5æœˆ</option>
                        <option value="6">6æœˆ</option>
                        <option value="7">7æœˆ</option>
                        <option value="8">8æœˆ</option>
                        <option value="9">9æœˆ</option>
                        <option value="10">10æœˆ</option>
                        <option value="11">11æœˆ</option>
                    </select>
                </div>

                <div class="filter-group">
                    <label for="distance-select">ğŸ† ç«¶æŠ€è·é›¢</label>
                    <select id="distance-select">
                        <option value="">ã™ã¹ã¦ã®è·é›¢</option>
                        <option value="ã‚¹ãƒ—ãƒªãƒ³ãƒˆ">ğŸ† ã‚¹ãƒ—ãƒªãƒ³ãƒˆ</option>
                        <option value="ã‚ªãƒªãƒ³ãƒ”ãƒƒã‚¯">ğŸ† ã‚ªãƒªãƒ³ãƒ”ãƒƒã‚¯</option>
                        <option value="ãƒŸãƒ‰ãƒ«">ğŸ† ãƒŸãƒ‰ãƒ«</option>
                        <option value="ãƒ­ãƒ³ã‚°">ğŸ† ãƒ­ãƒ³ã‚°</option>
                        <option value="ã‚¢ã‚¤ã‚¢ãƒ³ãƒãƒ³">ğŸ† ã‚¢ã‚¤ã‚¢ãƒ³ãƒãƒ³</option>
                        <option value="ãƒªãƒ¬ãƒ¼">ğŸ† ãƒªãƒ¬ãƒ¼</option>
                        <option value="ã‚¢ã‚¯ã‚¢ã‚¹ãƒ­ãƒ³">ğŸ† ã‚¢ã‚¯ã‚¢ã‚¹ãƒ­ãƒ³</option>
                        <option value="ãƒ‡ãƒ¥ã‚¢ã‚¹ãƒ­ãƒ³">ğŸ† ãƒ‡ãƒ¥ã‚¢ã‚¹ãƒ­ãƒ³</option>
                        <option value="ã‚­ãƒƒã‚º">ğŸ† ã‚­ãƒƒã‚º</option>
                        <option value="ã‚¨ã‚¤ã‚¸ã‚°ãƒ«ãƒ¼ãƒ—">ğŸ† ã‚¨ã‚¤ã‚¸ã‚°ãƒ«ãƒ¼ãƒ—</option>
                        <option value="ãƒãƒ¼ãƒ ">ğŸ† ãƒãƒ¼ãƒ </option>
                    </select>
                </div>

                <div class="filter-group">
                    <label for="search-input">ğŸ” å¤§ä¼šåæ¤œç´¢</label>
                    <input type="text" id="search-input" placeholder="å¤§ä¼šåã‚’å…¥åŠ›...">
                </div>
            </div>
        </div>

        <div class="stats">
            <h3 id="race-count">èª­ã¿è¾¼ã¿ä¸­...</h3>
        </div>

        <div class="debug-info" id="debug-info">
            <strong>ğŸ› ãƒ‡ãƒãƒƒã‚°æƒ…å ±:</strong><br>
            <div id="debug-content">åˆæœŸåŒ–ä¸­...</div>
        </div>

        <div class="race-grid" id="race-grid">
            <div style="text-align: center; padding: 40px; color: #666;">
                <h3>å¤§ä¼šãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿ä¸­...</h3>
            </div>
        </div>
    </div>

    <script>
        // ãƒ‡ãƒãƒƒã‚°ç”¨ãƒ­ã‚°é–¢æ•°
        function debugLog(message) {
            console.log('ğŸ› DEBUG:', message);
            const debugContent = document.getElementById('debug-content');
            if (debugContent) {
                debugContent.innerHTML += '<br>' + new Date().toLocaleTimeString() + ': ' + message;
            }
        }

        // DOMè¦ç´ ã®å®‰å…¨ãªå–å¾—
        function safeGetElement(id) {
            const element = document.getElementById(id);
            if (!element) {
                debugLog(`âŒ è¦ç´ ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“: ${id}`);
                return null;
            }
            debugLog(`âœ… è¦ç´ å–å¾—æˆåŠŸ: ${id}`);
            return element;
        }

        // å¤§ä¼šãƒ‡ãƒ¼ã‚¿
        const raceData = [
            {
                id: 1,
                name: "çŸ³å£å³¶ãƒˆãƒ©ã‚¤ã‚¢ã‚¹ãƒ­ãƒ³",
                region: "æ²–ç¸„",
                date: "2025-04-20",
                location: "çŸ³å£å¸‚",
                distance: "ã‚ªãƒªãƒ³ãƒ”ãƒƒã‚¯",
                description: "ç¾ã—ã„æµ·ã¨è‡ªç„¶ã«å›²ã¾ã‚ŒãŸå—å›½ã®ãƒˆãƒ©ã‚¤ã‚¢ã‚¹ãƒ­ãƒ³"
            },
            {
                id: 2,
                name: "æ¹˜å—å›½éš›ãƒˆãƒ©ã‚¤ã‚¢ã‚¹ãƒ­ãƒ³",
                region: "é–¢æ±",
                date: "2025-05-18",
                location: "è—¤æ²¢å¸‚",
                distance: "ã‚ªãƒªãƒ³ãƒ”ãƒƒã‚¯",
                description: "é–¢æ±æœ€å¤§ç´šã®ãƒˆãƒ©ã‚¤ã‚¢ã‚¹ãƒ­ãƒ³å¤§ä¼š"
            },
            {
                id: 3,
                name: "ä½æ¸¡å›½éš›ãƒˆãƒ©ã‚¤ã‚¢ã‚¹ãƒ­ãƒ³",
                region: "ä¸­éƒ¨",
                date: "2025-09-07",
                location: "ä½æ¸¡å¸‚",
                distance: "ãƒ­ãƒ³ã‚°",
                description: "æ—¥æœ¬æœ€é«˜å³°ã®ãƒ­ãƒ³ã‚°ãƒ‡ã‚£ã‚¹ã‚¿ãƒ³ã‚¹"
            },
            {
                id: 4,
                name: "å®®å¤å³¶ãƒˆãƒ©ã‚¤ã‚¢ã‚¹ãƒ­ãƒ³",
                region: "æ²–ç¸„",
                date: "2025-04-13",
                location: "å®®å¤å³¶å¸‚",
                distance: "ãƒ­ãƒ³ã‚°",
                description: "ã‚¨ãƒ¡ãƒ©ãƒ«ãƒ‰ãƒ–ãƒ«ãƒ¼ã®æµ·ãŒç¾ã—ã„å®®å¤å³¶"
            },
            {
                id: 5,
                name: "æ±äº¬ãƒˆãƒ©ã‚¤ã‚¢ã‚¹ãƒ­ãƒ³ãƒ•ã‚§ã‚¹ã‚¿",
                region: "é–¢æ±",
                date: "2025-05-25",
                location: "ãŠå°å ´",
                distance: "ã‚¹ãƒ—ãƒªãƒ³ãƒˆ",
                description: "éƒ½å¿ƒã§é–‹å‚¬ã•ã‚Œã‚‹äººæ°—å¤§ä¼š"
            }
        ];

        // ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³çŠ¶æ…‹
        let appState = {
            allRaces: [],
            filteredRaces: [],
            filters: {
                region: '',
                month: '',
                distance: '',
                search: ''
            }
        };

        // DOMè¦ç´ ã®å‚ç…§
        let elements = {};

        // åˆæœŸåŒ–é–¢æ•°
        function initializeApp() {
            debugLog('ğŸš€ ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³åˆæœŸåŒ–é–‹å§‹');

            // DOMè¦ç´ ã®å–å¾—
            elements = {
                regionSelect: safeGetElement('region-select'),
                monthSelect: safeGetElement('month-select'),
                distanceSelect: safeGetElement('distance-select'),
                searchInput: safeGetElement('search-input'),
                raceGrid: safeGetElement('race-grid'),
                raceCount: safeGetElement('race-count'),
                debugContent: safeGetElement('debug-content')
            };

            // å¿…é ˆè¦ç´ ã®å­˜åœ¨ç¢ºèª
            const requiredElements = ['regionSelect', 'monthSelect', 'distanceSelect', 'searchInput', 'raceGrid', 'raceCount'];
            const missingElements = requiredElements.filter(key => !elements[key]);

            if (missingElements.length > 0) {
                const errorMsg = `âŒ å¿…é ˆDOMè¦ç´ ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“: ${missingElements.join(', ')}`;
                debugLog(errorMsg);
                console.error(errorMsg);
                return false;
            }

            debugLog('âœ… å…¨ã¦ã®DOMè¦ç´ ã®å–å¾—å®Œäº†');

            // ãƒ‡ãƒ¼ã‚¿ã®åˆæœŸåŒ–
            appState.allRaces = [...raceData];
            appState.filteredRaces = [...raceData];

            debugLog(`ğŸ“Š å¤§ä¼šãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿å®Œäº†: ${appState.allRaces.length}ä»¶`);

            // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã®è¨­å®š
            setupEventListeners();

            // åˆæœŸè¡¨ç¤º
            updateDisplay();

            debugLog('ğŸ‰ åˆæœŸåŒ–å®Œäº†');
            return true;
        }

        // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã®è¨­å®š
        function setupEventListeners() {
            debugLog('ğŸ”— ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼è¨­å®šé–‹å§‹');

            if (elements.regionSelect) {
                elements.regionSelect.addEventListener('change', handleFilterChange);
            }
            if (elements.monthSelect) {
                elements.monthSelect.addEventListener('change', handleFilterChange);
            }
            if (elements.distanceSelect) {
                elements.distanceSelect.addEventListener('change', handleFilterChange);
            }
            if (elements.searchInput) {
                elements.searchInput.addEventListener('input', handleFilterChange);
            }

            debugLog('âœ… ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼è¨­å®šå®Œäº†');
        }

        // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼å¤‰æ›´å‡¦ç†
        function handleFilterChange() {
            debugLog('ğŸ”„ ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼å¤‰æ›´æ¤œå‡º');

            // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼å€¤ã®æ›´æ–°
            appState.filters = {
                region: elements.regionSelect?.value || '',
                month: elements.monthSelect?.value || '',
                distance: elements.distanceSelect?.value || '',
                search: elements.searchInput?.value || ''
            };

            debugLog(`ğŸ“ ç¾åœ¨ã®ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼: ${JSON.stringify(appState.filters)}`);

            // ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°å®Ÿè¡Œ
            applyFilters();

            // è¡¨ç¤ºæ›´æ–°
            updateDisplay();
        }

        // ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°å‡¦ç†
        function applyFilters() {
            appState.filteredRaces = appState.allRaces.filter(race => {
                // åœ°åŸŸãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
                if (appState.filters.region && race.region !== appState.filters.region) {
                    return false;
                }

                // æœˆãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
                if (appState.filters.month) {
                    const raceMonth = new Date(race.date).getMonth() + 1;
                    if (raceMonth !== parseInt(appState.filters.month)) {
                        return false;
                    }
                }

                // è·é›¢ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
                if (appState.filters.distance && race.distance !== appState.filters.distance) {
                    return false;
                }

                // æ¤œç´¢ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
                if (appState.filters.search) {
                    const searchTerm = appState.filters.search.toLowerCase();
                    if (!race.name.toLowerCase().includes(searchTerm) && 
                        !race.location.toLowerCase().includes(searchTerm)) {
                        return false;
                    }
                }

                return true;
            });

            debugLog(`ğŸ” ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°çµæœ: ${appState.filteredRaces.length}ä»¶`);
        }

        // è¡¨ç¤ºæ›´æ–°
        function updateDisplay() {
            debugLog('ğŸ–¥ï¸ è¡¨ç¤ºæ›´æ–°é–‹å§‹');

            // çµ±è¨ˆæƒ…å ±ã®æ›´æ–°
            if (elements.raceCount) {
                elements.raceCount.textContent = `${appState.filteredRaces.length} ä»¶ã®å¤§ä¼šãŒè¦‹ã¤ã‹ã‚Šã¾ã—ãŸ`;
            }

            // å¤§ä¼šä¸€è¦§ã®æ›´æ–°
            if (elements.raceGrid) {
                if (appState.filteredRaces.length === 0) {
                    elements.raceGrid.innerHTML = `
                        <div class="no-results">
                            <h3>è©²å½“ã™ã‚‹å¤§ä¼šãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸ</h3>
                            <p>ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼æ¡ä»¶ã‚’å¤‰æ›´ã—ã¦ãŠè©¦ã—ãã ã•ã„</p>
                        </div>
                    `;
                } else {
                    elements.raceGrid.innerHTML = appState.filteredRaces.map(race => createRaceCard(race)).join('');
                }
            }

            debugLog('âœ… è¡¨ç¤ºæ›´æ–°å®Œäº†');
        }

        // å¤§ä¼šã‚«ãƒ¼ãƒ‰ã®HTMLç”Ÿæˆ
        function createRaceCard(race) {
            const raceDate = new Date(race.date);
            const formattedDate = raceDate.toLocaleDateString('ja-JP', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });

            const distanceClass = race.distance.toLowerCase().replace(/[^a-z]/g, '');

            return `
                <div class="race-card">
                    <div class="race-card-header">
                        <h3>${race.name}</h3>
                    </div>
                    <div class="race-card-body">
                        <div class="race-info">
                            <div class="race-info-item">
                                <div class="icon">ğŸ“…</div>
                                <div class="text">${formattedDate}</div>
                            </div>
                            <div class="race-info-item">
                                <div class="icon">ğŸ“</div>
                                <div class="text">${race.location} (${race.region})</div>
                            </div>
                            <div class="race-info-item">
                                <div class="icon">ğŸ“</div>
                                <div class="text">${race.description}</div>
                            </div>
                        </div>
                        <div class="distance-badge ${distanceClass}">
                            ğŸ† ${race.distance}
                        </div>
                    </div>
                </div>
            `;
        }

        // DOMContentLoadedå¾Œã«åˆæœŸåŒ–
        document.addEventListener('DOMContentLoaded', function() {
            debugLog('ğŸ“„ DOMèª­ã¿è¾¼ã¿å®Œäº†');
            
            setTimeout(() => {
                const success = initializeApp();
                if (!success) {
                    debugLog('âŒ åˆæœŸåŒ–å¤±æ•—');
                    if (elements.raceGrid) {
                        elements.raceGrid.innerHTML = `
                            <div class="no-results">
                                <h3>âŒ åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼</h3>
                                <p>ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®åˆæœŸåŒ–ã«å¤±æ•—ã—ã¾ã—ãŸã€‚ãƒšãƒ¼ã‚¸ã‚’å†èª­ã¿è¾¼ã¿ã—ã¦ãã ã•ã„ã€‚</p>
                            </div>
                        `;
                    }
                }
            }, 100);
        });

        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿å®Œäº†å¾Œã®ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
        window.addEventListener('load', function() {
            debugLog('ğŸŒ ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿å®Œäº†');
            
            // DOMè¦ç´ ãŒè¦‹ã¤ã‹ã‚‰ãªã„å ´åˆã®å†è©¦è¡Œ
            if (!elements.regionSelect) {
                debugLog('ğŸ”„ DOMè¦ç´ å†å–å¾—ã‚’è©¦è¡Œ');
                setTimeout(() => {
                    initializeApp();
                }, 500);
            }
        });
    </script>
</body>
</html>
